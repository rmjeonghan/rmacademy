(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{63:(e,t,r)=>{"use strict";var a=r(7260);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},550:(e,t,r)=>{"use strict";r.d(t,{db:()=>i,j:()=>l});var a=r(2078),s=r(9708),u=r(2553);let n=(0,a.Dk)().length?(0,a.Sx)():(0,a.Wp)({apiKey:"AIzaSyC5SUu7e-aNUfgBEeEoXEwjONknWKhbtBI",authDomain:"rmcheck-4e79c.firebaseapp.com",projectId:"rmcheck-4e79c",storageBucket:"rmcheck-4e79c.firebasestorage.app",messagingSenderId:"1081522017302",appId:"1:1081522017302:web:b7bd3e0436a05c92c29137"}),i=(0,s.aU)(n),l=(0,u.xI)(n)},2064:(e,t,r)=>{Promise.resolve().then(r.bind(r,7322))},3136:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(5155);function s(){return(0,a.jsx)("div",{className:"flex justify-center items-center p-4",children:(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-slate-200 border-t-[var(--primary)] rounded-full animate-spin"})})}},7322:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var a=r(5155),s=r(2115),u=r(63),n=r(9730),i=r(3136);function l(){let{user:e,loading:t}=(0,n.A)(),r=(0,u.useRouter)();return(0,s.useEffect)(()=>{t||e||r.push("/login"),!t&&e&&r.push("/dashboard")},[e,t,r]),(0,a.jsx)(i.A,{})}},9730:(e,t,r)=>{"use strict";r.d(t,{A:()=>o,AuthProvider:()=>d});var a=r(5155),s=r(2115),u=r(2553),n=r(550),i=r(9708),l=r(3136);let c=(0,s.createContext)({user:null,loading:!0}),d=e=>{let{children:t}=e,[r,d]=(0,s.useState)(null),[o,m]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{let e=(0,u.hg)(n.j,async e=>{if(e){let r={...e};try{var t;if(null==(t=e.email)?void 0:t.endsWith("@rulemakers.co.kr"))r.role="superadmin";else{let t=(0,i.rJ)(n.db,"academies"),a=(0,i.P)(t,(0,i._M)("adminEmail","==",e.email),(0,i._M)("isDeleted","==",!1)),s=await (0,i.GG)(a);if(s.empty)await n.j.signOut(),r=null;else{let e=s.docs[0];r&&(r.role="academyadmin",r.academyId=e.id,r.academyName=e.data().name)}}}catch(e){console.error("Failed to fetch user role, signing out.",e),await n.j.signOut(),r=null}d(r)}else d(null);m(!1)});return()=>e()},[]),o)?(0,a.jsx)(l.A,{}):(0,a.jsx)(c.Provider,{value:{user:r,loading:o},children:t})},o=()=>(0,s.useContext)(c)}},e=>{e.O(0,[135,965,240,441,255,358],()=>e(e.s=2064)),_N_E=e.O()}]);
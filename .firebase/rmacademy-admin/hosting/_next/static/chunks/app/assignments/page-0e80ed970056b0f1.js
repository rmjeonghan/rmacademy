(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[431],{550:(e,t,s)=>{"use strict";s.d(t,{db:()=>i,j:()=>c});var a=s(2078),r=s(9708),l=s(2553);let n=(0,a.Dk)().length?(0,a.Sx)():(0,a.Wp)({apiKey:"AIzaSyC5SUu7e-aNUfgBEeEoXEwjONknWKhbtBI",authDomain:"rmcheck-4e79c.firebaseapp.com",projectId:"rmcheck-4e79c",storageBucket:"rmcheck-4e79c.firebasestorage.app",messagingSenderId:"1081522017302",appId:"1:1081522017302:web:b7bd3e0436a05c92c29137"}),i=(0,r.aU)(n),c=(0,l.xI)(n)},3136:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(5155);function r(){return(0,a.jsx)("div",{className:"flex justify-center items-center p-4",children:(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-slate-200 border-t-[var(--primary)] rounded-full animate-spin"})})}},5066:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(5155),r=s(2115),l=s(9708),n=s(550);let i={"통합과학 1":[{id:"1-1",name:"과학의 기초",subChapters:["1-1-1: 시간과 공간","1-1-2: 기본량과 단위","1-1-3: 측정과 측정 표준","1-1-4: 정보와 디지털 기술"]},{id:"1-2",name:"원소의 형성",subChapters:["1-2-1: 우주 초기에 형성된 원소","1-2-2: 지구와 생명체를 이루는 원소의 생성"]},{id:"1-3",name:"물질의 규칙성과 성질",subChapters:["1-3-1: 원소의 주기성과 화학 결합","1-3-2: 이온 결합과 공유 결합","1-3-3: 지각과 생명체 구성 물질의 규칙성","1-3-4: 물질의 전기적 성질"]},{id:"1-4",name:"지구시스템",subChapters:["1-4-1: 지구시스템의 구성 요소","1-4-2: 지구시스템의 상호작용","1-4-3: 지권의 변화"]},{id:"1-5",name:"역학 시스템",subChapters:["1-5-1: 중력과 역학 시스템","1-5-2: 운동과 충돌"]},{id:"1-6",name:"생명 시스템",subChapters:["1-6-1: 생명 시스템의 기본 단위","1-6-2: 물질대사와 효소","1-6-3: 세포 내 정보의 흐름"]}],"통합과학 2":[{id:"2-1",name:"지질 시대와 생물 다양성",subChapters:["2-1-1: 지질시대의 생물과 화석","2-1-2: 자연선택과 진화","2-1-3: 생물다양성과 보전"]},{id:"2-2",name:"화학 변화",subChapters:["2-2-1: 산화와 환원","2-2-2: 산성과 염기성","2-2-3: 중화 반응","2-2-4: 물질 변화에서 에너지 출입"]},{id:"2-3",name:"생태계와 환경 변화",subChapters:["2-3-1: 생태계 구성 요소","2-3-2: 생태계 평형","2-3-3: 기후 변화와 지구 환경 변화"]},{id:"2-4",name:"에너지와 지속가능한 발전",subChapters:["2-4-1: 태양 에너지의 생성과 전환","2-4-2: 전기 에너지의 생산","2-4-3: 에너지 효율과 신재생 에너지"]},{id:"2-5",name:"과학과 미래 사회",subChapters:["2-5-1: 과학의 유용성과 필요성","2-5-2: 과학 기술 사회와 빅데이터","2-5-3: 과학 기술의 발전과 미래 사회","2-5-4: 과학 관련 사회적 쟁점과 과학 윤리"]}]};var c=s(8122),d=s(9730),o=s(3136);function m(e){let{isOpen:t,onClose:s,onConfirm:l,initialSelectedIds:n}=e,[c,d]=(0,r.useState)(new Set(n));return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:(0,a.jsxs)("div",{className:"modal-content bg-white rounded-lg shadow-xl w-full max-w-2xl flex flex-col",children:[(0,a.jsxs)("header",{className:"p-4 border-b border-slate-200 flex justify-between items-center bg-blue-600 text-white rounded-t-lg",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"과제 범위 단원 선택"}),(0,a.jsx)("button",{onClick:s,className:"text-white hover:text-blue-200 text-3xl font-light",children:"\xd7"})]}),(0,a.jsx)("div",{className:"flex-grow overflow-y-auto max-h-[70vh] p-4",children:Object.entries(i).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold my-2 sticky top-0 bg-white py-2 border-b border-slate-100",children:t}),s.map(e=>(0,a.jsxs)("div",{className:"ml-4 mb-3",children:[(0,a.jsx)("h4",{className:"font-semibold text-slate-800",children:e.name}),(0,a.jsx)("ul",{className:"pl-4 mt-1 space-y-1",children:e.subChapters.map(e=>{let[t,...s]=e.split(":"),r=s.join(":").trim();return(0,a.jsx)("li",{children:(0,a.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer p-1 rounded hover:bg-gray-100 transition-colors",children:[(0,a.jsx)("input",{type:"checkbox",checked:c.has(t),onChange:()=>(e=>{let t=new Set(c);t.has(e)?t.delete(e):t.add(e),d(t)})(t),className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500"}),(0,a.jsxs)("span",{className:"text-sm text-slate-700",children:[r," ",(0,a.jsxs)("span",{className:"text-xs text-slate-500",children:["(",t,")"]})]})]})},t)})})]},e.id))]},t)})}),(0,a.jsx)("footer",{className:"p-4 bg-gray-50 border-t border-slate-200 text-right rounded-b-lg",children:(0,a.jsx)("button",{onClick:()=>l(Array.from(c)),className:"btn-primary",children:"선택 완료"})})]})}):null}function u(){let{user:e,loading:t}=(0,d.A)(),s=(null==e?void 0:e.role)==="superadmin",[i,u]=(0,r.useState)([]),[h,x]=(0,r.useState)([]),[b,p]=(0,r.useState)([]),[f,j]=(0,r.useState)(""),[g,v]=(0,r.useState)(""),[y,N]=(0,r.useState)(new Date().toISOString().split("T")[0]),[w,O]=(0,r.useState)(""),[C,k]=(0,r.useState)(new Map),[S,P]=(0,r.useState)([]),[D,I]=(0,r.useState)(!1);(0,r.useEffect)(()=>{e&&(s?(0,l.aQ)((0,l.rJ)(n.db,"academies"),e=>u(e.docs.map(e=>({id:e.id,...e.data()})))):e.academyId&&j(e.academyId))},[e,s]),(0,r.useEffect)(()=>{f&&(0,l.aQ)((0,l.P)((0,l.rJ)(n.db,"classes"),(0,l._M)("academyId","==",f)),e=>{x(e.docs.map(e=>({id:e.id,...e.data()})))})},[f]),(0,r.useEffect)(()=>{if(!f||!g)return void p([]);let e=(0,l.P)((0,l.rJ)(n.db,"academyAssignments"),(0,l._M)("academyId","==",f),(0,l._M)("classId","==",g)),t=(0,l.aQ)(e,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()})).filter(e=>e.createdAt);t.sort((e,t)=>t.createdAt.toMillis()-e.createdAt.toMillis()),p(t)});return()=>t()},[f,g]);let E=async()=>{if(!f||!g||!w.trim()||0===C.size||0===S.length)return void alert("모든 필드를 올바르게 입력해주세요.");let e=["일","월","화","수","목","금","토"],t=Array.from(C.entries()).map(t=>{let[s,a]=t,r={academyId:f,classId:g,title:w,dayTitle:"".concat(e[s],"요일 과제"),assignedUnitIds:S,dueDate:l.Dc.fromDate(a),createdAt:(0,l.O5)()};return(0,l.gS)((0,l.rJ)(n.db,"academyAssignments"),r)});await Promise.all(t),alert("".concat(t.length,"개의 일일 과제가 등록되었습니다.")),O(""),k(new Map),P([])},A=async e=>{confirm("정말로 이 과제를 삭제하시겠습니까?")&&await (0,l.kd)((0,l.H9)(n.db,"academyAssignments",e))},M=e=>{let{day:t,dayIndex:s}=e,r=new Date(y+"T00:00:00"),l=r.getDay(),n=new Date(r),i=s-l;i<0&&(i+=7),n.setDate(r.getDate()+i);let c=C.has(s);return(0,a.jsxs)("button",{onClick:()=>{let e=new Map(C);c?e.delete(s):e.set(s,n),k(e)},className:"assignment-btn flex flex-col items-center justify-center p-2 ".concat(c?"active":""),children:[(0,a.jsx)("span",{className:"font-semibold",children:t}),(0,a.jsx)("span",{className:"text-xs mt-1",children:"".concat(n.getMonth()+1,"/").concat(n.getDate())})]})};return t?(0,a.jsx)(o.A,{}):(0,a.jsxs)("div",{className:"p-8 overflow-y-auto h-full bg-gray-50",children:[(0,a.jsxs)("header",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold font-lexend text-slate-800",children:s?"학원 과제 관리":"수업 과제 관리"}),(0,a.jsx)("p",{className:"mt-2 text-md text-slate-500",children:"날짜를 기반으로 유연하게 과제를 할당합니다."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm space-y-4 border border-slate-200",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-slate-800",children:"새 과제 할당"}),s&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"1. 대상 학원"}),(0,a.jsxs)("select",{value:f,onChange:e=>{j(e.target.value),v("")},className:"form-select",children:[(0,a.jsx)("option",{value:"",children:"학원 선택"}),i.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"1. 대상 수업"}),(0,a.jsxs)("select",{value:g,onChange:e=>v(e.target.value),className:"form-select",disabled:!f||!h.length,children:[(0,a.jsx)("option",{value:"",children:"수업 선택"}),h.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"2. 과제 시작일"}),(0,a.jsx)("input",{type:"date",value:y,onChange:e=>N(e.target.value),className:"form-input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"3. 과제 이름"}),(0,a.jsx)("input",{type:"text",value:w,onChange:e=>O(e.target.value),placeholder:"예: 1주차 역학 시스템",className:"form-input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"form-label",children:"4. 과제 요일 및 마감일 선택"}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-2",children:["일","월","화","수","목","금","토"].map((e,t)=>(0,a.jsx)(M,{day:e,dayIndex:t},t))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"5. 과제 범위"}),(0,a.jsx)("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-md text-sm text-slate-600 min-h-[40px] flex items-center",children:S.length>0?(0,a.jsxs)("span",{className:"flex items-center space-x-2",children:[(0,a.jsx)(c.D1A,{className:"text-blue-500"}),(0,a.jsxs)("span",{children:["총 ",S.length,"개 소단원 선택됨"]})]}):(0,a.jsx)("span",{className:"text-gray-400",children:"선택된 단원이 없습니다."})}),(0,a.jsx)("button",{onClick:()=>I(!0),className:"mt-2 w-full btn-secondary",children:"단원 선택하기"})]}),(0,a.jsx)("button",{onClick:E,className:"w-full btn-primary py-3",children:"선택한 요일에 과제 저장하기"})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-slate-800",children:"할당된 과제 목록"}),(0,a.jsx)("div",{className:"space-y-3 max-h-[calc(100vh-250px)] overflow-y-auto",children:b.length>0?b.map(e=>(0,a.jsx)("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-bold text-slate-800",children:[e.title," (",e.dayTitle,")"]}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:["마감일: ",new Date(e.dueDate.toMillis()).toLocaleDateString("ko-KR")," | 범위: 총 ",e.assignedUnitIds.length,"개 소단원"]})]}),(0,a.jsx)("button",{onClick:()=>A(e.id),className:"text-red-500 hover:text-red-700 p-2 rounded hover:bg-red-100 transition-colors",title:"과제 삭제",children:(0,a.jsx)(c.IXo,{})})]})},e.id)):(0,a.jsx)("p",{className:"text-center text-slate-500 py-4",children:"선택된 수업에 할당된 과제가 없습니다."})})]})]}),(0,a.jsx)(m,{isOpen:D,onClose:()=>I(!1),onConfirm:e=>{P(e),I(!1)},initialSelectedIds:S})]})}},6238:(e,t,s)=>{Promise.resolve().then(s.bind(s,5066))},6724:(e,t,s)=>{"use strict";s.d(t,{k5:()=>o});var a=s(2115),r={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},l=a.createContext&&a.createContext(r),n=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,a)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(Object(s),!0).forEach(function(t){var a,r,l;a=e,r=t,l=s[t],(r=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(r))in a?Object.defineProperty(a,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[r]=l}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function o(e){return t=>a.createElement(m,i({attr:d({},e.attr)},t),function e(t){return t&&t.map((t,s)=>a.createElement(t.tag,d({key:s},t.attr),e(t.child)))}(e.child))}function m(e){var t=t=>{var s,{attr:r,size:l,title:c}=e,o=function(e,t){if(null==e)return{};var s,a,r=function(e,t){if(null==e)return{};var s={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;s[a]=e[a]}return s}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)s=l[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}(e,n),m=l||t.size||"1em";return t.className&&(s=t.className),e.className&&(s=(s?s+" ":"")+e.className),a.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,o,{className:s,style:d(d({color:e.color||t.color},t.style),e.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),c&&a.createElement("title",null,c),e.children)};return void 0!==l?a.createElement(l.Consumer,null,e=>t(e)):t(r)}},9730:(e,t,s)=>{"use strict";s.d(t,{A:()=>m,AuthProvider:()=>o});var a=s(5155),r=s(2115),l=s(2553),n=s(550),i=s(9708),c=s(3136);let d=(0,r.createContext)({user:null,loading:!0}),o=e=>{let{children:t}=e,[s,o]=(0,r.useState)(null),[m,u]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{let e=(0,l.hg)(n.j,async e=>{if(e){let s={...e};try{var t;if(null==(t=e.email)?void 0:t.endsWith("@rulemakers.co.kr"))s.role="superadmin";else{let t=(0,i.rJ)(n.db,"academies"),a=(0,i.P)(t,(0,i._M)("adminEmail","==",e.email),(0,i._M)("isDeleted","==",!1)),r=await (0,i.GG)(a);if(r.empty)await n.j.signOut(),s=null;else{let e=r.docs[0];s&&(s.role="academyadmin",s.academyId=e.id,s.academyName=e.data().name)}}}catch(e){console.error("Failed to fetch user role, signing out.",e),await n.j.signOut(),s=null}o(s)}else o(null);u(!1)});return()=>e()},[]),m)?(0,a.jsx)(c.A,{}):(0,a.jsx)(d.Provider,{value:{user:s,loading:m},children:t})},m=()=>(0,r.useContext)(d)}},e=>{e.O(0,[135,965,844,240,441,255,358],()=>e(e.s=6238)),_N_E=e.O()}]);